# 機能実装: 学習統計ダッシュボード

## 要件

### 機能要件

#### 統計データ
1. **学習時間**
   - 日別・週別・月別の学習時間
   - 総学習時間
   - 平均学習時間

2. **進捗状況**
   - 完了ページ数
   - 習得単語数
   - 習得フレーズ数
   - 完了書籍数

3. **連続学習記録**
   - 現在の連続日数
   - 最長連続日数
   - ストリーク表示

4. **学習分析**
   - 学習時間の推移グラフ
   - 習得単語数の推移
   - 発音スコアの平均
   - 弱点分析（苦手な単語・フレーズ）

### 非機能要件

- **パフォーマンス**:
  - 統計データ取得: 500ms以内
  - グラフ描画: 1秒以内
  - 大量データ（1年分以上）への対応

- **セキュリティ**:
  - ユーザー認証必須
  - 統計データのプライバシー保護

- **拡張性**:
  - 将来的な分析機能追加への対応
  - カスタムレポート生成

- **エラーハンドリング**:
  - データ不整合の処理
  - グラフ描画エラーの処理

## 実装指示

### Step 1: テスト設計

1. **ユニットテスト**
   - 統計データ計算
   - グラフデータ生成
   - 日付範囲のフィルタリング

2. **統合テスト**
   - 統計データ取得
   - グラフ表示
   - データ集計

3. **エッジケースのテスト**
   - データなしの場合
   - 大量データ（1年分以上）
   - 日付境界値

テストファイルは `backend/internal/service/stats/stats_test.go` に配置。

### Step 2: 実装

#### 実装ファイル構造

```
backend/
├── internal/
│   ├── service/
│   │   └── stats/
│   │       ├── service.go           # 統計サービス
│   │       └── service_test.go
│   └── repository/
│       └── stats.go                  # 統計DB操作

frontend/web/
├── components/
│   └── stats/
│       ├── Dashboard.tsx             # ダッシュボード
│       ├── LearningTimeChart.tsx     # 学習時間グラフ
│       └── ProgressChart.tsx         # 進捗グラフ
```

#### APIエンドポイント

```
GET /api/v1/stats/dashboard
GET /api/v1/stats/learning-time
GET /api/v1/stats/progress
GET /api/v1/stats/streak
```

## 制約事項

- 既存の `backend/internal/models/` は変更しない（新規追加のみ）
- `backend/internal/service/stats/` 配下のみ編集可能

## 完了条件

- [ ] すべてのテストが通る
- [ ] lintエラーがない
- [ ] タイプエラーがない
- [ ] ドキュメントが更新されている
- [ ] 統計データの正確性確認
- [ ] グラフ表示の動作確認
